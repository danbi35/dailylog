<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë‚˜ì˜ ì¼ê¸° ë¸”ë¡œê·¸</title>
<style>
  body {
    font-family: 'Noto Sans KR', sans-serif;
    background: #f7f9fb;
    margin: 0;
    padding: 0;
    color: #222;
  }
  header {
    background: #4e7cff;
    color: white;
    text-align: center;
    padding: 18px;
    font-size: 22px;
    font-weight: bold;
  }
  main {
    max-width: 800px;
    margin: 20px auto;
    padding: 10px;
  }
  form {
    background: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    margin-bottom: 20px;
  }
  input, textarea, select, button {
    font-family: inherit;
  }
  input[type="text"], input[type="date"], textarea, select {
    width: 100%;
    margin: 8px 0 12px 0;
    padding: 10px;
    font-size: 14px;
    border: 1px solid #ccc;
    border-radius: 8px;
    box-sizing: border-box;
  }
  textarea {
    min-height: 100px;
    resize: vertical;
  }
  button {
    background: #4e7cff;
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
  }
  button:hover {
    background: #3b63d1;
  }
  .entry {
    background: white;
    border-radius: 8px;
    padding: 16px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    margin-bottom: 12px;
  }
  .entry h3 {
    margin: 0 0 8px 0;
  }
  .entry p {
    white-space: pre-wrap;
  }
  .entry small {
    color: #666;
  }
  .entry .actions {
    margin-top: 8px;
  }
  .entry .actions button {
    background: #ddd;
    color: #333;
    font-size: 13px;
    padding: 6px 10px;
    margin-right: 6px;
  }
  .entry .actions button.delete {
    background: #ff5c5c;
    color: white;
  }
  #searchBox {
    width: 100%;
    padding: 8px;
    font-size: 14px;
    border: 1px solid #ccc;
    border-radius: 8px;
    margin-bottom: 20px;
  }
</style>
</head>
<body>
<header>ğŸ“” ë‚˜ì˜ ì¼ê¸° ë¸”ë¡œê·¸</header>
<main>
  <form id="diaryForm">
    <label>ì œëª©</label>
    <input type="text" id="title" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" required>

    <label>ë‚ ì§œ</label>
    <input type="date" id="date" required>

    <label>ê¸°ë¶„</label>
    <select id="mood">
      <option value="">ì„ íƒ ì•ˆ í•¨</option>
      <option>ğŸ˜€ ì¢‹ìŒ</option>
      <option>ğŸ™‚ í‰ë²”</option>
      <option>ğŸ˜¢ ìŠ¬í””</option>
      <option>ğŸ˜¡ í™”ë‚¨</option>
    </select>

    <label>ë‚´ìš©</label>
    <textarea id="content" placeholder="ì˜¤ëŠ˜ ìˆì—ˆë˜ ì¼ì„ ì ì–´ë³´ì„¸ìš”" required></textarea>

    <button type="submit">ì €ì¥</button>
  </form>

  <input type="text" id="searchBox" placeholder="ì œëª©ì´ë‚˜ ë‚´ìš©ì„ ê²€ìƒ‰í•˜ì„¸ìš” ğŸ”">

  <div id="entries"></div>
</main>

<script>
  const form = document.getElementById("diaryForm");
  const entriesDiv = document.getElementById("entries");
  const searchBox = document.getElementById("searchBox");

  let entries = JSON.parse(localStorage.getItem("diaryEntries") || "[]");

  function saveEntries() {
    localStorage.setItem("diaryEntries", JSON.stringify(entries));
  }

  function renderEntries(filter = "") {
    entriesDiv.innerHTML = "";
    const filtered = entries.filter(e => 
      e.title.toLowerCase().includes(filter.toLowerCase()) ||
      e.content.toLowerCase().includes(filter.toLowerCase())
    );
    if (filtered.length === 0) {
      entriesDiv.innerHTML = "<p style='text-align:center;color:#777;'>ì‘ì„±ëœ ì¼ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>";
      return;
    }
    filtered.sort((a, b) => new Date(b.date) - new Date(a.date));
    filtered.forEach((entry, index) => {
      const div = document.createElement("div");
      div.className = "entry";
      div.innerHTML = `
        <h3>${entry.title}</h3>
        <small>${entry.date} ${entry.mood || ""}</small>
        <p>${entry.content}</p>
        <div class="actions">
          <button onclick="editEntry(${index})">ìˆ˜ì •</button>
          <button class="delete" onclick="deleteEntry(${index})">ì‚­ì œ</button>
        </div>
      `;
      entriesDiv.appendChild(div);
    });
  }

  form.addEventListener("submit", e => {
    e.preventDefault();
    const title = document.getElementById("title").value.trim();
    const date = document.getElementById("date").value;
    const mood = document.getElementById("mood").value;
    const content = document.getElementById("content").value.trim();

    if (!title || !content) return alert("ì œëª©ê³¼ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");

    entries.push({ title, date, mood, content });
    saveEntries();
    renderEntries();
    form.reset();
  });

  function deleteEntry(index) {
    if (confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
      entries.splice(index, 1);
      saveEntries();
      renderEntries();
    }
  }

  function editEntry(index) {
    const e = entries[index];
    document.getElementById("title").value = e.title;
    document.getElementById("date").value = e.date;
    document.getElementById("mood").value = e.mood;
    document.getElementById("content").value = e.content;
    entries.splice(index, 1);
    saveEntries();
    renderEntries();
    window.scrollTo({ top: 0, behavior: "smooth" });
  }

  searchBox.addEventListener("input", e => {
    renderEntries(e.target.value);
  });

  // ì˜¤ëŠ˜ ë‚ ì§œ ìë™ ì…ë ¥
  document.getElementById("date").value = new Date().toISOString().split("T")[0];

  renderEntries();
</script>
</body>
</html>
