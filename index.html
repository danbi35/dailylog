<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>나의 일기 블로그</title>
<style>
  body {
    font-family: 'Noto Sans KR', sans-serif;
    background: #f7f9fb;
    margin: 0;
    padding: 0;
    color: #222;
  }
  header {
    background: #4e7cff;
    color: white;
    text-align: center;
    padding: 18px;
    font-size: 22px;
    font-weight: bold;
  }
  main {
    max-width: 800px;
    margin: 20px auto;
    padding: 10px;
  }
  form {
    background: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    margin-bottom: 20px;
  }
  input, textarea, select, button {
    font-family: inherit;
  }
  input[type="text"], input[type="date"], textarea, select {
    width: 100%;
    margin: 8px 0 12px 0;
    padding: 10px;
    font-size: 14px;
    border: 1px solid #ccc;
    border-radius: 8px;
    box-sizing: border-box;
  }
  textarea {
    min-height: 100px;
    resize: vertical;
  }
  button {
    background: #4e7cff;
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
  }
  button:hover {
    background: #3b63d1;
  }
  .entry {
    background: white;
    border-radius: 8px;
    padding: 16px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    margin-bottom: 12px;
  }
  .entry h3 {
    margin: 0 0 8px 0;
  }
  .entry p {
    white-space: pre-wrap;
  }
  .entry small {
    color: #666;
  }
  .entry .actions {
    margin-top: 8px;
  }
  .entry .actions button {
    background: #ddd;
    color: #333;
    font-size: 13px;
    padding: 6px 10px;
    margin-right: 6px;
  }
  .entry .actions button.delete {
    background: #ff5c5c;
    color: white;
  }
  #searchBox {
    width: 100%;
    padding: 8px;
    font-size: 14px;
    border: 1px solid #ccc;
    border-radius: 8px;
    margin-bottom: 20px;
  }
</style>
</head>
<body>
<header>📔 나의 일기 블로그</header>
<main>
  <form id="diaryForm">
    <label>제목</label>
    <input type="text" id="title" placeholder="제목을 입력하세요" required>

    <label>날짜</label>
    <input type="date" id="date" required>

    <label>기분</label>
    <select id="mood">
      <option value="">선택 안 함</option>
      <option>😀 좋음</option>
      <option>🙂 평범</option>
      <option>😢 슬픔</option>
      <option>😡 화남</option>
    </select>

    <label>내용</label>
    <textarea id="content" placeholder="오늘 있었던 일을 적어보세요" required></textarea>

    <button type="submit">저장</button>
  </form>

  <input type="text" id="searchBox" placeholder="제목이나 내용을 검색하세요 🔍">

  <div id="entries"></div>
</main>

<script>
  const form = document.getElementById("diaryForm");
  const entriesDiv = document.getElementById("entries");
  const searchBox = document.getElementById("searchBox");

  let entries = JSON.parse(localStorage.getItem("diaryEntries") || "[]");

  function saveEntries() {
    localStorage.setItem("diaryEntries", JSON.stringify(entries));
  }

  function renderEntries(filter = "") {
    entriesDiv.innerHTML = "";
    const filtered = entries.filter(e => 
      e.title.toLowerCase().includes(filter.toLowerCase()) ||
      e.content.toLowerCase().includes(filter.toLowerCase())
    );
    if (filtered.length === 0) {
      entriesDiv.innerHTML = "<p style='text-align:center;color:#777;'>작성된 일기가 없습니다.</p>";
      return;
    }
    filtered.sort((a, b) => new Date(b.date) - new Date(a.date));
    filtered.forEach((entry, index) => {
      const div = document.createElement("div");
      div.className = "entry";
      div.innerHTML = `
        <h3>${entry.title}</h3>
        <small>${entry.date} ${entry.mood || ""}</small>
        <p>${entry.content}</p>
        <div class="actions">
          <button onclick="editEntry(${index})">수정</button>
          <button class="delete" onclick="deleteEntry(${index})">삭제</button>
        </div>
      `;
      entriesDiv.appendChild(div);
    });
  }

  form.addEventListener("submit", e => {
    e.preventDefault();
    const title = document.getElementById("title").value.trim();
    const date = document.getElementById("date").value;
    const mood = document.getElementById("mood").value;
    const content = document.getElementById("content").value.trim();

    if (!title || !content) return alert("제목과 내용을 입력해주세요!");

    entries.push({ title, date, mood, content });
    saveEntries();
    renderEntries();
    form.reset();
  });

  function deleteEntry(index) {
    if (confirm("정말 삭제하시겠습니까?")) {
      entries.splice(index, 1);
      saveEntries();
      renderEntries();
    }
  }

  function editEntry(index) {
    const e = entries[index];
    document.getElementById("title").value = e.title;
    document.getElementById("date").value = e.date;
    document.getElementById("mood").value = e.mood;
    document.getElementById("content").value = e.content;
    entries.splice(index, 1);
    saveEntries();
    renderEntries();
    window.scrollTo({ top: 0, behavior: "smooth" });
  }

  searchBox.addEventListener("input", e => {
    renderEntries(e.target.value);
  });

  // 오늘 날짜 자동 입력
  document.getElementById("date").value = new Date().toISOString().split("T")[0];

  renderEntries();
</script>
</body>
</html>
